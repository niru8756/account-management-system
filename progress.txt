
[2026-01-24] Authentication Feature Complete
- Added NextAuth configuration with credentials provider
- Created login page at /login with email/password form
- Added middleware to protect all routes except /login and /api/auth
- Updated Prisma schema with User model (id, email, name, role)
- Added SessionProvider to app providers
- Updated home page to display authenticated user info
- Added typecheck and test scripts to package.json
- Test credentials: admin@company.com / password or manager@company.com / password
- All protected routes now require authentication
- Types check successfully, tests pass


[2026-01-24] Seller Registry Feature Complete
- Added Seller model to Prisma schema (businessName, contactName, email, phone, address)
- Migrated database to SQLite with Prisma 7 and LibSQL adapter
- Created /api/sellers routes for GET (list) and POST (create)
- Created /api/sellers/[id] route for GET (individual seller)
- Built /sellers page with seller list table and add seller form
- Built /sellers/[id] page for seller profile view
- Added "Manage Sellers" link to home page
- Configured Prisma client with @prisma/adapter-libsql
- Types check successfully, tests pass
- Users can now navigate to sellers, add new sellers with business details, view seller list, and open individual seller profiles


[2026-01-24] Document Collection Feature Complete
- Added Document model to Prisma schema with relation to Seller (fileName, fileUrl, tags)
- Created /api/sellers/[id]/documents routes for GET (list) and POST (upload)
- Added Documents section to seller profile page with upload form
- Documents display with file name, tags, creation date, and view link
- Form includes fields for file name, file URL, and tags (KYC, PAN, Compliance)
- Documents are linked to seller via sellerId foreign key with cascade delete
- Types check successfully, tests pass
- Internal users can now upload documents, assign tags, and view all documents for a seller


[2026-01-24] One-Time Upload Link Feature Complete
- Added UploadLink model to Prisma schema (token, used, expiresAt, sellerId)
- Created /api/sellers/[id]/upload-links routes for POST (generate) and GET (list)
- Created /api/upload route for public document upload via token
- Built /upload page for external users to upload documents using token
- Added upload link generation UI to seller profile page
- Links expire after use or after 7 days
- Updated middleware to allow public access to /upload and /api/upload
- Upload links display status (Active/Used/Expired) and expiration time
- Types check successfully, tests pass
- External sellers can now receive a one-time link, upload documents securely, and links automatically expire after single use


[2026-01-24] Payments Feature Complete
- Added Payment model to Prisma schema (amount, paymentDate, reference, proofOfPayment)
- Created /api/sellers/[id]/payments routes for GET (list) and POST (create)
- Added Payments section to seller profile page with payment recording form
- Form includes fields for amount, payment date, reference (optional), and proof of payment URL
- Payments display with amount, date, reference, recorded timestamp, and link to proof
- Payments are linked to seller via sellerId foreign key with cascade delete
- Types check successfully, tests pass
- Internal users can now record payments with metadata, upload proof of payment, and view all payments for a seller


[2026-01-24] Invoice Generation Feature Complete
- Added Invoice model to Prisma schema with relation to Payment (invoiceNumber, pdfUrl)
- Created /api/payments/[id]/invoices routes for POST (generate) and GET (list)
- Added invoice generation UI to seller profile payment records
- Each payment can have multiple invoices with unique invoice numbers
- Invoice numbers auto-generated with format INV-{timestamp}
- Invoices display with number, creation date, and PDF download link
- Regenerated Prisma client to include Invoice model
- Types check successfully, tests pass
- Internal users can now generate invoices from payment records, view invoice numbers, and download invoice PDFs


[2026-01-24] Internal Communication Feature Complete
- Added InternalNote model to Prisma schema (content, attachmentUrl, sellerId)
- Created /api/sellers/[id]/notes routes for GET (list) and POST (create)
- Added Internal Notes section to seller profile page with note form
- Form includes fields for note content (required) and attachment URL (optional)
- Notes display with content, attachment link, and creation timestamp
- Notes are linked to seller via sellerId foreign key with cascade delete
- Notes ordered by creation date (most recent first)
- Types check successfully, tests pass
- Internal users can now add structured notes, attach optional documents, and view all notes for a seller


[2026-01-24] Audit and Visibility Feature Complete
- Added AuditLog model to Prisma schema (userId, action, entityType, entityId, details)
- Created audit logging utility function in lib/audit.ts
- Added audit logging to seller creation (CREATE_SELLER action)
- Added audit logging to document upload (UPLOAD_DOCUMENT action)
- Created /api/audit-logs route to fetch audit logs
- Built /audit-logs page to display audit log table
- Added "Audit Logs" link to home page
- Extended NextAuth session type to include user id
- Updated JWT and session callbacks to pass user id
- Types check successfully, tests pass
- Internal users can now view all actions with user, action type, entity, timestamp, and details for full accountability


[2026-01-24] Proposal Management Feature Complete
- Added Proposal model to Prisma schema (fileName, fileUrl, shareable, sellerId)
- Created /api/sellers/[id]/proposals routes for GET (list) and POST (create)
- Added Proposals section to seller profile page with upload form
- Form includes fields for file name, file URL, and shareable checkbox
- Proposals display with file name, visibility flag (Shareable/Internal Only), and creation date
- Proposals are linked to seller via sellerId foreign key with cascade delete
- Shareable flag defaults to false (internal only)
- Types check successfully, tests pass
- Internal users can now upload proposal documents, mark them as shareable or internal, and view all proposals for a seller


[2026-01-24] Lifecycle Tracking Feature Complete
- Added LifecycleHistory model to Prisma schema (marketplace, stage, sellerId)
- Created /api/sellers/[id]/lifecycle routes for GET (list) and POST (create)
- Added Lifecycle Tracking section to seller profile page with update form
- Form includes fields for marketplace and lifecycle stage
- History displays with marketplace, stage, and timestamp
- Lifecycle entries are linked to seller via sellerId foreign key with cascade delete
- History ordered by creation date (most recent first)
- Types check successfully, tests pass
- Internal users can now track seller lifecycle per marketplace, update stages, and view complete history with timestamps


[2026-01-27] Edit Seller Feature Complete
- Added accountManager and serviceNote fields to Seller model in Prisma schema
- Updated database schema from PostgreSQL to SQLite (file:./dev.db)
- Created PUT endpoint at /api/sellers/[id] for updating seller information
- Added edit mode toggle to seller profile page with inline form
- Edit form includes all seller fields: businessName, contactName, email, phone, address, accountManager, serviceNote
- Updated seller creation form to include accountManager and serviceNote fields
- Edit button toggles between view and edit modes on seller profile
- Types check successfully, tests pass
- Internal users can now edit all seller information including assigning account managers and capturing service notes


[2026-01-27] Document Edit/Delete Feature Complete
- Created PUT and DELETE endpoints at /api/documents/[id] for updating and removing documents
- Added edit mode toggle for each document in seller profile page
- Edit form includes inline fields for fileName, fileUrl, and tags
- Added delete button with confirmation dialog
- Edit and delete buttons appear alongside view link for each document
- Types check successfully, tests pass
- Internal users can now correct document metadata mistakes and remove outdated documents


[2026-01-27] PostgreSQL Database Migration Complete
- Migrated database from SQLite to PostgreSQL as per PRD technical constraints
- Updated Prisma schema to use PostgreSQL provider
- Removed SQLite-specific LibSQL adapter configuration
- Installed and configured @prisma/adapter-pg for PostgreSQL connection
- Updated prisma.config.ts to use DATABASE_URL environment variable
- Updated Prisma client initialization with PostgreSQL adapter and pg Pool
- Added @types/pg for TypeScript support
- Updated migration file to include accountManager and serviceNote fields
- Created docker-compose.yml for local PostgreSQL development
- Types check successfully, tests pass
- Database now complies with PRD requirement: PostgreSQL >= 13 only (SQLite explicitly excluded)
- Note: PostgreSQL server must be running at localhost:5451 for migrations to apply


[2026-01-27] One-Time Upload Link Removal Complete
- Removed UploadLink model from Prisma schema
- Removed uploadLinks relation from Seller model
- Deleted /api/upload route (public document upload endpoint)
- Deleted /upload page (external user upload interface)
- Deleted /api/sellers/[id]/upload-links routes (generate and list endpoints)
- Updated middleware to remove /upload and /api/upload from public access matcher
- Removed upload link UI section from seller profile page
- Removed UploadLink type, state, and all related functions (fetchUploadLinks, generateUploadLink)
- Regenerated Prisma client with updated schema
- Types check successfully, tests pass
- System now exclusively uses internal document upload, no external upload links exist
- Note: Database migration pending - requires PostgreSQL server running at localhost:5451


[2026-01-27] Structured Account Manager Fields Complete
- Replaced single accountManager field with three structured fields in Prisma schema
- Added accountManagerName, accountManagerMobile, accountManagerEmail fields to Seller model
- Updated seller profile page to display and edit three separate account manager fields
- Updated seller creation form to include three account manager fields
- Grouped account manager fields with visual separation and "Optional" label
- Updated API routes to accept and store structured account manager data
- Service Note field already implemented and working (serviceNote field)
- Regenerated Prisma client with updated schema
- Types check successfully, tests pass
- Internal users can now capture complete account manager contact information with name, mobile, and email
- Note: Database migration pending - requires PostgreSQL server running at localhost:5451


[2026-01-27] Seller List UI Revamp Complete
- Created shadcn/ui Table component (table.tsx) with TableHeader, TableBody, TableRow, TableHead, TableCell
- Created shadcn/ui Button component (button.tsx) with variant and size props
- Created shadcn/ui Card component (card.tsx) with CardHeader, CardTitle, CardContent
- Refactored /sellers page to use shadcn/ui Table component for seller list
- Replaced custom button styling with shadcn/ui Button component
- Updated table to use consistent shadcn/ui styling with hover states
- Improved spacing and alignment using Tailwind utilities
- Empty state now uses TableCell with proper styling
- Form styling updated with consistent spacing (space-y-6, mb-1.5)
- Types check successfully, tests pass
- Seller list now has clean, modern UI with proper hover states and consistent typography


[2026-01-27] Seller Profile Page UI Revamp Complete
- Refactored seller profile page to use shadcn/ui Card components for all sections
- Created Input, Label, Textarea, and Badge shadcn/ui components
- Updated Button component to support asChild prop with Radix UI Slot
- Installed @radix-ui/react-label and @radix-ui/react-slot dependencies
- Split profile into clearly defined Card sections: Details, Documents, Payments, Proposals, Lifecycle, Notes
- Replaced all custom form inputs with shadcn/ui Input and Textarea components
- Replaced all custom labels with shadcn/ui Label component
- Updated document tags to use Badge component with secondary variant
- Improved form spacing and layout with consistent space-y-* utilities
- Added grid layout for seller details in view mode (2 columns)
- Updated all buttons to use shadcn/ui Button component with appropriate variants
- Changed page background to bg-gray-50 for better visual separation
- Increased max-width from max-w-4xl to max-w-6xl for better content display
- Used muted-foreground color for labels and secondary text
- Empty states now use centered text with muted-foreground color
- Types check successfully, tests pass
- Seller profile page now has clean, modern UI with proper Card-based sections and consistent shadcn/ui styling


[2026-01-27] Global Layout and Forms UI Revamp Complete
- Created AppLayout component with consistent header and navigation
- Added header with "Seller Management" branding and navigation links
- Navigation highlights active page with secondary variant button
- Applied AppLayout to all main pages: home, sellers list, seller profile, audit logs
- Refactored home page to use Card components for navigation sections
- Updated sellers list page to use shadcn/ui Input, Label, Textarea components in add seller form
- Wrapped add seller form in Card component with CardHeader and CardTitle
- Updated audit logs page to use shadcn/ui Table component
- Added empty states to audit logs table with centered muted text
- All pages now have consistent max-w-7xl container with px-6 py-8 spacing
- Removed redundant page-level background colors (now handled by AppLayout)
- All forms now use shadcn/ui components with consistent spacing (space-y-2 for fields, space-y-6 for sections)
- Optional fields clearly marked with muted-foreground text
- Types check successfully, tests pass
- All pages now have consistent layout, navigation, and styling with shadcn/ui components throughout


[2026-01-27] Login Page UI Refactor Complete
- Created shadcn/ui Alert component with destructive variant for error messages
- Refactored login page to use shadcn/ui Card, CardHeader, CardTitle, CardContent
- Replaced native HTML input elements with shadcn/ui Input component
- Replaced native HTML label elements with shadcn/ui Label component
- Replaced native HTML button with shadcn/ui Button component
- Error messages now use Alert component with AlertDescription
- Updated background to bg-gray-50 for consistency with other pages
- Improved form spacing with space-y-2 for fields and space-y-6 for sections
- Types check successfully, tests pass
- Login page now fully complies with shadcn/ui mandatory usage policy
- All UI refactor targets in PRD are now complete (Seller List, Seller Profile, Document Section, Forms, Notes & Service Field, Feedback & States)


[2026-01-28] Feedback & States Implementation Complete
- Implemented Skeleton component for all loading states across the application
- Replaced "Loading..." text in seller profile page with structured Skeleton layout
- Replaced "Loading..." text in audit logs page with structured Skeleton layout
- Added toast notifications for all success actions using sonner library
- Toast notifications added for: seller creation, seller update, document upload/edit/delete, payment recording, invoice generation, note creation, proposal upload, and lifecycle updates
- All loading states now use shadcn/ui Skeleton component as required by PRD
- All success actions now trigger Toast notifications as required by PRD
- Types check successfully, tests pass
- Feedback & States feature now fully compliant with PRD requirements (Skeleton for loading, Alert for errors, Toast for success)
